<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
	th:replace="bs::layout(~{::section})">
<head>
</head>
<body>


	<!-- Start Cart Area -->
	<section class="cart-area ptb-100">
	
	<!-- start messages of success and error -->
			<div th:if="${session.message}" class="text-center">
				<div th:classappend="${session.message.type}"
					class="alert alert-primary" role="alert">
					<span th:text="${session.message.content}"></span>
				</div>
				<th:block th:text="${#session.removeAttribute('message')}"></th:block>
			</div>
			<!-- end messages of success and error -->
	
	<div th:if="${#lists.size(cartItems) == 0}" class="error-area">
		<div class="container">
                <div class="error-content">
                    <img th:src="@{/images/empty-cart.webp}" alt="error">
                    <h3 class="animate-charcter">Your cart is empty!</h3>
                    <p>Add items to it now.</p>
                    <a th:href="@{/product/page=0}" class="default-btn">Shop now</a>
                </div>
            </div>
	</div>
	
		<div th:unless="${#lists.size(cartItems) == 0}" class="container">

			<form>
				<div class="cart-table table-responsive">
					<table class="table table-bordered">
						<thead>
							<tr>
								<th scope="col">Product</th>
								<th scope="col">Name</th>
								<th scope="col">Unit Price</th>
								<th scope="col">Quantity</th>
								<th scope="col">Total</th>
							</tr>
						</thead>

						<tbody>
							<tr th:each="cartItem : ${cartItems}">
								<td class="product-thumbnail"><a th:href="@{'/product/' + ${cartItem.product.id}}"> <img
										th:src="@{'/product_img/' + ${cartItem.product.productImages[0].productPic}}"
										style="height: 20vh;" alt="item">
								</a></td>

								<td class="product-name"><a th:href="@{'/product/' + ${cartItem.product.id}}"
									th:text="${cartItem.product.name}"></a>
									<ul>
										<li>Brand: <span th:text="${cartItem.product.brandName}">Light
												Blue</span></li>
										<li>Estimated Delivery: <span
											th:with="estimatedDeliveryDate=${#temporals.createNow().plusDays(cartItem.product.estimatedDeliveryDays)}">
												<span
												th:text="${#temporals.format(estimatedDeliveryDate, 'EEEE, MMMM dd, yyyy')}"></span>
										</span></li>
										<li><div class="price" style="text-decoration: line-through;"><i
											class="fa-solid fa-indian-rupee-sign text-muted text-decoration-line-through"></i>
											<span class="old-price" th:text="${cartItem.product.price}"></span>
										</div></li>
									</ul></td>

								<td class="product-price"><span class="unit-amount"
									th:text="${'&#8377;' + cartItem.product.getPriceAfterApplyingDiscount()}"></span>

								</td>
								<td class="product-quantity">
									<div class="input-counter">
										<a th:if="${cartItem.quantity != 1}"
											th:href="@{'/user/cart/decrease-quantity/'+${cartItem.id}}"
											class="minus-btn"><i class='bx bx-minus'></i></a> <input
											th:data-item-price="${cartItem.product.getPriceAfterApplyingDiscount()}"
											th:data-cart-id="${cartItem.id}" type="text" min="1" max="5"
											th:value="${cartItem.quantity}"> <a
											th:if="${cartItem.quantity != 5}"
											th:href="@{'/user/cart/increase-quantity/'+${cartItem.id}}"
											class="plus-btn"><i class='bx bx-plus'></i></a>
									</div>
								</td>

								<td class="product-subtotal"><span class="subtotal-amount"
									th:text="${'&#8377;' + cartItem.product.getPriceAfterApplyingDiscount() * cartItem.quantity}"></span>
									<a th:href="@{'/user/cart/remove-cart-item/' + ${cartItem.id}}"
									class="remove"><i class='bx bx-trash'></i></a></td>
							</tr>
						</tbody>
					</table>
				</div>

				<div class="cart-buttons">
					<div class="row align-items-center">

						<div class="col-lg-12 col-sm-12 col-md-12 text-end">
							<a th:href="@{/product/page=0}" class="default-btn">Continue Shopping</a>
						</div>
					</div>
				</div>

				<div class="cart-totals">
					<h3>Cart Totals</h3>

					<ul>
						<li>Price <span th:text="${'&#8377;' + totalAmount}"></span></li>
						<li>Discount <span
							th:text="${'- ' + '&#8377;' + (totalAmount - totalDiscountedAmount)}"></span></li>
						<li>Delivery Charges <span>FREE</span></li>
						<li>Total <span
							th:text="${'&#8377;' + totalDiscountedAmount}"></span></li>
					</ul>

					<a th:href="@{/user/order/checkout-order}" class="default-btn">Proceed to Checkout</a>
				</div>
			</form>
		</div>




	</section>
	<!-- End Cart Area -->

</body>
</html>