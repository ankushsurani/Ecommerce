<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
	th:replace="bs::layout(~{::section})">
<head>

</head>
<body>


	<!-- Start Checkout Area -->
	<section class="checkout-area ptb-100">
		<div class="container">


			<!-- messages of success and error -->
			<div th:if="${session.message}" class="text-center me-3">
				<div th:classappend="${session.message.type}"
					class="alert alert-primary" role="alert">
					<span th:text="${session.message.content}"></span>
				</div>
				<th:block th:text="${#session.removeAttribute('message')}"></th:block>
			</div>
			<!-- end error and success message -->



			<div class="row">



				<div class="col-lg-6 col-md-12">
					<div class="billing-details">
						<h3 class="title">Billing Details</h3>

						<div class="row">
							<div class="col-lg-12 col-md-6">
								<div class="form-group">
									<label>Full Name <span class="required">*</span></label> <input
										disabled="disabled" th:value="${user.fullName}" type="text"
										class="form-control">
								</div>
							</div>

							<div class="col-lg-12 col-md-6">
								<div class="form-group">
									<label>Email Address <span class="required">*</span></label> <input
										disabled="disabled" th:value="${user.email}" type="email"
										class="form-control">
								</div>
							</div>

							<div class="col-lg-12 col-md-12">
								<div class="form-group">
									<label>Select Delivery Address <span class="required">*</span></label>

									<form th:action="@{/user/order/send-order-cod}" method="post">
										<div class="card rounded-0 mb-3"
											style="background-color: #f5f5f5;"
											th:each="address : ${user.address}" th:if="${address.active}">
											<div class="card-body">
												<div class="d-flex flex-column flex-xl-row gap-3">
													<div class="address-info form-check flex-grow-1">
														<input class="form-check-input" type="radio"
															id="flexRadioDefaultAddress1"
															th:checked="${address.addressType == 'MAIN'}"
															name="orderAddress" th:value="${address.id}"> <label
															class="form-check-label" for="flexRadioDefaultAddress1">
															<span class="fw-bold mb-0 h5" th:text="${address.name}"></span><br>
															<span th:text="${address.fullAddress}"></span> <br>
															<span
															th:text="${address.city + ' , ' + address.state + ' - ' + address.pincode}"></span><br>
															Mobile: <span class="text-dark fw-bold"
															th:text="${address.mobilenum}"></span>
														</label>
													</div>
												</div>
											</div>

										</div>
								</div>

								<button type="button" class="optional-btn"
									th:data-pagename="checkout" data-bs-toggle="modal"
									data-bs-target="#OrderAddress">Ship to a different
									address?</button>
							</div>
						</div>
					</div>
				</div>

				<div class="col-lg-6 col-md-12">
					<div class="order-details">
						<h3 class="title">Your Order</h3>

						<div class="order-table table-responsive">
							<table class="table table-bordered">
								<thead>
									<tr>
										<th scope="col">Product Name</th>
										<th scope="col">Total</th>
									</tr>
								</thead>

								<tbody>
									<tr th:each="checkoutCartItem : ${checkoutCartItems}">
										<td class="product-name"><a
											th:href="@{'/product/' + ${checkoutCartItem.product.id}}"
											th:text="${checkoutCartItem.product.name}"></a></td>

										<td class="product-total"><span class="subtotal-amount"
											th:text="${'&#8377;' + checkoutCartItem.product.getPriceAfterApplyingDiscount()}"></span>
										</td>
									</tr>

									<tr>
										<td class="order-subtotal"><span>Order Subtotal</span></td>

										<td class="order-subtotal-price"><span
											class="order-subtotal-amount"
											th:text="${'&#8377;' + totalDiscountedAmount}"></span></td>
									</tr>

									<tr>
										<td class="order-shipping"><span>Shipping</span></td>

										<td class="shipping-price"><span>FREE</span></td>
									</tr>

									<tr>
										<td class="total-price"><span>Order Total</span></td>

										<td class="product-subtotal"><span
											class="subtotal-amount"
											th:text="${'&#8377;' + totalDiscountedAmount}"></span></td>
									</tr>
								</tbody>
							</table>
						</div>

						<div class="payment-box">
							<div class="payment-method">
								<p>Payment Options</p>
								<p>
									<input type="radio" id="paypal" name="paymentOption"
										value="Pay Online" checked> <label for="paypal">Pay
										Online</label>
								</p>
								<p th:if="${param.payMode == online}">
									<input type="radio" id="cash-on-delivery" name="paymentOption"
										value="Cash On Delivery"> <label
										for="cash-on-delivery">Cash on Delivery</label>
								</p>
							</div>




							<th:block th:each="checkoutCartItem : ${checkoutCartItems}">
								<input type="text" hidden="" th:name="cartItemId"
									th:value="${checkoutCartItem.id}" />
							</th:block>


							<button th:if="${param.payMode == online}" type="submit"
								class="default-btn">Place Order</button>

							</form>
							<button th:if="${param.payMode != online}"
								th:onclick="|paymentStart('${totalDiscountedAmount}')|"
								class="default-btn">Select Payment Mode</button>
						</div>
					</div>
				</div>

			</div>
		</div>


		<!-- New Address Modal -->
		<form th:action="@{/user/order/add-address}" method="post"
			th:object="${address}">
			<div class="modal" id="OrderAddress" tabindex="-1">

				<div
					class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
					<div class="modal-content rounded-0">


						<div class="modal-header">
							<h5 class="modal-title fw-bold">Add New Address</h5>
							<button type="button" class="btn-close" data-bs-dismiss="modal"
								aria-label="Close"></button>
						</div>




						<div class="modal-body">
							<div class="">
								<h6 class="fw-bold mb-3">Contact Details</h6>


								<!-- messages of success and error -->
								<div th:if="${session.message}" class="text-center">
									<div th:classappend="${session.message.type}"
										class="alert alert-primary" role="alert">
										<span th:text="${session.message.content}"></span>
									</div>
									<th:block th:text="${#session.removeAttribute('message')}"></th:block>
								</div>



								<div class="form-floating mb-3">
									<input type="text" name="name" class="form-control rounded-0"
										id="floatingName" placeholder="Name"
										th:value="${address.name}"
										th:classappend="${#fields.hasErrors('name') ? 'is-invalid' : ''}">
									<div th:each="e : ${#fields.errors('name')}" th:text="${e}"
										class="text-red-500 text-xs invalid-feedback"></div>

									<label for="floatingName">Name</label>
								</div>
								<div class="form-floating mb-3">
									<input type="number" name="mobilenum"
										class="form-control rounded-0" id="floatingMobileNo"
										placeholder="Mobile No" th:value="${address.mobilenum}"
										th:classappend="${#fields.hasErrors('mobilenum') ? 'is-invalid' : ''}">
									<div th:each="e : ${#fields.errors('mobilenum')}"
										th:text="${e}" class="text-red-500 text-xs invalid-feedback"></div>
									<label for="floatingMobileNo">Mobile No</label>
								</div>
							</div>

							<div class="mt-4">
								<h6 class="fw-bold mb-3">Address</h6>
								<div class="form-floating mb-3">
									<input type="number" name="pincode"
										class="form-control rounded-0" id="floatingPinCode"
										placeholder="Pin Code" th:value="${address.pincode}"
										th:classappend="${#fields.hasErrors('pincode') ? 'is-invalid' : ''}">
									<div th:each="e : ${#fields.errors('pincode')}" th:text="${e}"
										class="text-red-500 text-xs invalid-feedback"></div>
									<label for="floatingPinCode">Pin Code</label>
								</div>
								<div class="form-floating mb-3">
									<input type="text" name="fullAddress"
										class="form-control rounded-0" id="floatingAddress"
										placeholder="Address (House No, Building, Street, Area)"
										th:value="${address.fullAddress}"
										th:classappend="${#fields.hasErrors('fullAddress') ? 'is-invalid' : ''}">
									<div th:each="e : ${#fields.errors('fullAddress')}"
										th:text="${e}" class="text-red-500 text-xs invalid-feedback"></div>
									<label for="floatingAddress">Address</label>
								</div>
								<div class="form-floating mb-3">
									<input type="text" name="localityOrTown"
										class="form-control rounded-0" id="floatingLocalityTown"
										placeholder="Locality/Town"
										th:value="${address.localityOrTown}"
										th:classappend="${#fields.hasErrors('localityOrTown') ? 'is-invalid' : ''}">
									<div th:each="e : ${#fields.errors('localityOrTown')}"
										th:text="${e}" class="text-red-500 text-xs invalid-feedback"></div>
									<label for="floatingLocalityTown">Locality / Town</label>
								</div>
								<div class="row">
									<div class="col">
										<div class="form-floating">
											<input type="text" name="city" class="form-control rounded-0"
												id="floatingCity" placeholder="City / District"
												th:value="${address.city}"
												th:classappend="${#fields.hasErrors('city') ? 'is-invalid' : ''}">
											<div th:each="e : ${#fields.errors('city')}" th:text="${e}"
												class="text-red-500 text-xs invalid-feedback"></div>
											<label for="floatingAddress">City / District</label>
										</div>
									</div>
									<div class="col">
										<div class="form-floating">
											<input type="text" name="state"
												class="form-control rounded-0" id="floatingState"
												placeholder="State" th:value="${address.state}"
												th:classappend="${#fields.hasErrors('state') ? 'is-invalid' : ''}">
											<div th:each="e : ${#fields.errors('state')}" th:text="${e}"
												class="text-red-500 text-xs invalid-feedback"></div>
											<label for="floatingState">State</label>
										</div>
									</div>

									<input hidden="" id="pagename">

								</div>
							</div>

						</div>

						<div class="modal-footer">
							<div class="d-grid w-100">
								<button type="submit" class="btn btn-dark py-3 px-5 btn-ecomm">Add
									Address</button>
							</div>
						</div>


					</div>
				</div>

			</div>
		</form>
		<!-- end New Address Modal -->


		<script>
			// Function to toggle the addressDiv based on the checkbox state
			function toggleAddressDiv() {
				var checkbox = document
						.getElementById("ship-different-address");
				var addressDiv = document.getElementById("addressDiv");

				if (checkbox.checked) {
					addressDiv.style.display = "block"; // Show the addressDiv
				} else {
					addressDiv.style.display = "none"; // Hide the addressDiv
				}
			}
		</script>



	</section>
	<!-- End Checkout Area -->


</body>
</html>